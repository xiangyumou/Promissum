# Chaster - 产品需求文档 (PRD)

## 📋 产品概述

### 项目名称
**Chaster** - 基于时间锁加密的内容保护应用

### 产品定位
Chaster 是一个时间锁加密内容保护应用的**客户端**，它通过调用独立部署的**加密服务 API**，利用**时间锁加密技术 (Timelock Encryption)** 和 **drand 去中心化随机信标网络**，允许用户对文本或图片内容进行加密，并设定一个未来的解锁时间。在设定的时间到达之前，任何人（包括用户自己）都无法解密查看内容，从而实现真正的"强制自律"功能。

### 架构说明
```
前端 UI (Next.js)
    ↓
本地 API Routes (代理层)
    ↓
远程加密服务 API
    ↓
时间锁加密 + drand 网络
```

### 核心价值主张
- **强制时间锁定**：基于密码学的时间锁，而非简单的软件限制，无法提前解密
- **远程服务架构**：调用独立的加密 API 服务，分离前后端关注点
- **功能完备**：包含仪表盘、多语言、主题定制等完整应用特性
- **灵活扩展**：支持延长锁定时间（多层加密）

---

## 🎯 目标用户

### 主要用户群体
1. **自律提升者**：希望通过"强制锁定"机制来提升自控力的用户
2. **隐私保护者**：需要对敏感信息进行时间限制访问的用户
3. **创意工作者**：希望在特定时间后才公开作品的创作者
4. **教育场景**：教师可以提前准备考试答案，在考试结束后自动解锁

### 典型使用场景
- 🎮 锁定游戏账号密码，强制学习/工作时间
- 💌 给未来的自己写信，设定未来某天才能查看
- 🎁 准备惊喜礼物信息，在特定日期自动揭晓
- 📝 锁定敏感文档，仅在需要时才能访问
- 🔐 存储紧急备份密码，设定冷却期防止冲动操作

---

## 🚀 核心功能

### 1. 内容加密与时间锁定

#### 功能描述
用户可以创建加密项目，支持两种内容类型：
- **文本内容**：直接输入文字信息
- **图片内容**：上传图片文件（PNG, JPG, GIF, WebP），支持粘贴上传

#### 时间设定方式

##### 方式一：持续时长模式 (Duration Mode)
- 预设快捷按钮：`1分钟`、`10分钟`、`1小时`、`6小时`、`1天`
- 支持多次点击累加时长
- 自定义输入框：可输入任意分钟数
- 重置按钮：清空当前设定

##### 方式二：绝对时间模式 (Absolute Time Mode)
- 直接指定解锁时间点（格式可配置）
- 系统验证输入时间必须在未来
- 自动显示与当前时间的倒计时

#### 界面展示
- **预览解锁时间**：动态显示解锁的具体日期时间
- **剩余时间显示**：倒计时格式

#### 技术实现要点
- 远程 API 处理加密逻辑 (`tlock-js` + `drand`)
- **多层加密** (layer_count)：支持对已加密内容再次加密

---

### 2. 加密项目管理

#### 侧边栏列表 (Sidebar)
- **排序与筛选**：
  - 支持按创建时间、解锁时间排序
  - 支持按状态（锁定/解锁）、类型（文本/图片）筛选
  - 实时搜索过滤
- **项目卡片信息**：
  - 内容类型图标：📝 文本 / 🖼️ 图片
  - 项目名称：支持自定义标题
  - 锁定状态：实时倒计时或 Unlocked 状态
  - 隐私模式：支持模糊显示敏感信息

#### 项目详情视图 (ContentView)
- **顶部信息栏**：
  - 内容类型 + 名称
  - 多层加密标识：`×N`
  - 操作栏：删除、延长锁定
- **锁定状态显示**：
  - 🔒 动态倒计时，每秒刷新
  - Unlocks at 具体时间显示
- **解锁状态显示**：
  - **文本内容**：显示明文，支持一键复制
  - **图片内容**：LightBox 预览，支持缩放、下载

---

### 3. Dashboard 仪表盘

#### 功能描述
提供全局数据的可视化概览，帮助用户了解使用情况。

#### 展示指标
- **系统总览**：总项目数、已加密、已解锁数量
- **类型分布**：文本 vs 图片比例
- **平均锁定时间**：用户的平均自律时长
- **状态分布**：锁定/解锁比例图表

---

### 4. 设置与个性化 (Settings)

#### 功能描述
全方位的应用配置中心，支持实时保存。

#### 配置项
1. **默认行为**：默认锁定时长、确认对话框开关、自动刷新间隔
2. **外观定制**：
   - 主题切换：浅色 / 深色 / 系统跟随
   - 主题色定制：自定义主色、背景色等 CSS 变量
   - 语言切换：English / 中文
3. **隐私安全**：
   - 隐私模式：默认模糊列表内容
   - 自动隐私模式：无操作一段时间后自动进入隐私模式
   - 紧急按钮 (Panic Button)：快捷键跳转指定 URL
   - 缓存策略：自定义解密内容在本地的缓存时间 (TTL)
4. **数据管理**：
   - 导出数据：导出已解锁内容为 JSON/Markdown
   - 清除数据：重置所有设置或缓存

---

## 🎨 用户界面设计

### 设计风格
- **现代化 UI**：采用 Radix UI 组件库，保证无障碍访问
- **自适应主题**：完美支持深色模式 (Dark Mode)
- **交互设计**：
  - 平滑的过渡动画 (Framer Motion)
  - 响应式布局：移动端底部弹窗 (Sheet)、侧边栏自动收起
  - 加载骨架屏 (Skeleton) 优化体验

### 布局结构
#### 桌面端
- 左侧固定侧边栏 (Sidebar)
- 右侧主内容区域，支持宽屏展示

#### 移动端
- 底部导航/菜单
- 侧边栏以抽屉形式弹出
- 针对触摸操作优化的按钮尺寸

---

## 🔧 技术架构

### 技术栈 (Current)

#### 前端框架
- **Next.js 16.0.10**：App Router 架构
- **React 19.2.1**：最新 React 特性支持
- **TypeScript 5**：全类型安全

#### 状态与数据
- **Zustand 5**：全局 UI 状态管理 (Settings, Sidebar)
- **React Query 5**：服务端状态管理、缓存、持久化
- **next-intl**：国际化方案

#### UI 与样式
- **Tailwind CSS 4**：下一代原子化 CSS
- **Radix UI**：无头组件库 (Dialog, Slot, VisuallyHidden)
- **Framer Motion**：动画库
- **Lucide React**：图标库

#### 工具库
- **date-fns**：日期处理
- **zod**：Schema 验证
- **react-use**：Hooks 工具集

### 目录结构
```
src/
├── app/
│   ├── [locale]/     # 国际化路由
│   ├── api/          # 代理 API
├── components/       # 组件
│   ├── ui/           # 通用原子组件
├── lib/
│   ├── stores/       # Zustand Stores
│   ├── queries.ts    # React Query 定义
├── messages/         # 翻译 JSON
```

---

## 🔐 安全性与隐私

### 加密流程
1. 前端调用 API 代理
2. 远程服务使用 `tlock-js` 加密
3. 加密数据 (Ciphertext) 存入 SQLite
4. 到达时间后，远程服务解密并返回

### 前端安全
- **敏感数据不持久化**：解密后的明文内容主要在内存中
- **可配置缓存**：用户通过 TTL 设置控制 localStorage 中明文缓存时间
- **API Token 保护**：Token 仅在服务端环境便量，前端通过代理转发

---

## 🎯 产品路线图

### 已完成 (v0.3.0)
- ✅ 核心加密/解密功能
- ✅ 设置页面与个性化
- ✅ 仪表盘统计
- ✅ 移动端适配
- ✅ 国际化 (i18n)
- ✅ 深色模式
- ✅ 数据导出

### 未来规划
- 🔮 **批量操作**：批量删除、批量延长
- 🔮 **通知提醒**：浏览器通知或邮件提醒即将解锁
- 🔮 **多用户支持**：账号系统，云端同步
- 🔮 **文件类型扩展**：支持 PDF、音频、视频等
- 🔮 **离线解密**：下载加密文件，到时间后无需网络即可解密

---

## 📝 总结

Chaster 已从一个基础的加密工具进化为功能完备的内容保护客户端。通过引入现代化的技术栈（React Query, Zustand, Radix UI）和完善的功能模块（Dashboard, Settings, i18n），它不仅提供了强大的安全性，还保证了优秀的用户体验和可维护性。

---

**文档版本**：v2.0
**更新时间**：2025-12-28
**项目状态**：Feature Complete (v0.3.0)
